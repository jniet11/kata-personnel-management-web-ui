(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[591],{6534:(e,a,s)=>{Promise.resolve().then(s.bind(s,8925))},8925:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var t=s(5155),r=s(2115),n=s(5695),l=s(6766),o=s(3464);function i(){let e=(0,n.useRouter)(),a=(0,n.useParams)().id,[s,i]=(0,r.useState)(null),[d,u]=(0,r.useState)([]),[c,m]=(0,r.useState)(""),[g,p]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[b,f]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!0),[j,N]=(0,r.useState)(null),[A,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{(i(null),m(""),p(""),h(""),N(null),w(null),y(!0),a&&"undefined"!==a)?Promise.all([o.A.get("http://localhost:4000/personnel-management/get-assignment-by-id/".concat(a)),o.A.get("http://localhost:4000/personnel-management/get-users")]).then(e=>{let[a,s]=e;if(a.data.success&&a.data.data){let e=a.data.data;i(e),m(String(e.user_id)),p(e.computer_serial||""),e.assigned_at&&h(new Date(e.assigned_at).toISOString().split("T")[0])}else N(a.data.error||"No se pudo cargar la asignaci\xf3n.");let t=s.data.filter(e=>"aprobado"===e.status.toLowerCase());u(t),0===t.length&&!A&&s.data&&w("No hay usuarios aprobados disponibles para seleccionar.")}).catch(e=>{var a,s;console.error("Error fetching data:",e),N("Error al cargar los datos. Por favor, int\xe9ntelo m\xe1s tarde."),o.A.isAxiosError(e)&&(null==(s=e.config)||null==(a=s.url)?void 0:a.includes("get-users"))&&!A&&w("No se pudieron cargar la lista de usuarios aprobados.")}).finally(()=>{y(!1)}):(N("undefined"===a?"El ID de la asignaci\xf3n es 'undefined'.":"ID de asignaci\xf3n no v\xe1lido o no proporcionado."),y(!1))},[a]);let S=async t=>{if(t.preventDefault(),s){if(!c)return void N("Por favor, seleccione un usuario.");if(!g)return void N("Por favor, ingrese el n\xfamero de serie del equipo.");f(!0),N(null);try{await o.A.put("http://localhost:4000/personnel-management/update-assignment/".concat(a),{user_id:c,computer_serial_number:g,assigned_at:x}),alert("Asignaci\xf3n actualizada exitosamente!"),e.push("/team-management")}catch(e){if(console.error("Error updating assignment:",e),o.A.isAxiosError(e)&&e.response){var r;N((null==(r=e.response.data)?void 0:r.error)||"Error al actualizar la asignaci\xf3n.")}else N("Error de red o al procesar la solicitud de actualizaci\xf3n.")}finally{f(!1)}}};return v?(0,t.jsx)("div",{className:"container mx-auto p-6 text-center text-gray-600",children:"Cargando datos..."}):!j||s||v?s||v?(0,t.jsxs)("div",{className:"bg-white p-6 md:p-8 rounded-xl shadow-xl w-full max-w-2xl mx-auto my-8",children:[(0,t.jsxs)("div",{className:"flex items-center mb-6",children:[(0,t.jsx)("div",{className:"bg-blue-600 p-3 rounded-full mr-4",children:(0,t.jsx)(l.default,{className:"shrink-0",src:"/img/computer-svgrepo-com.svg",alt:"Editar Asignaci\xf3n",width:48,height:48})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-700",children:"Editar Asignaci\xf3n de Computador"})]}),(0,t.jsxs)("form",{onSubmit:S,children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"user",className:"block text-sm font-medium text-gray-700 mb-1",children:"Colaborador Asignado"}),A&&!v&&0===d.length?(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:A}):(0,t.jsxs)("select",{name:"user",id:"user",value:c,onChange:e=>{m(e.target.value)},className:"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0,disabled:v||0===d.length,children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Seleccione un usuario"}),d.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id)),0===d.length&&!v&&!A&&(0,t.jsx)("option",{value:"",disabled:!0,children:"No hay usuarios aprobados"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"computerSerial",className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero de Serie del Equipo"}),(0,t.jsx)("input",{type:"text",name:"computerSerial",id:"computerSerial",value:g,onChange:e=>{p(e.target.value)},className:"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"assignedAt",className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Asignaci\xf3n"}),(0,t.jsx)("input",{type:"date",name:"assignedAt",id:"assignedAt",value:x,onChange:e=>{h(e.target.value)},className:"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0})]})]}),j&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-4 mb-4",children:j}),(0,t.jsx)("div",{className:"mt-8 pt-5 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:()=>e.push("/team-management"),className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg mr-3 transition duration-200",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",disabled:b||v||!s||0===d.length&&!A,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transition duration-200 disabled:opacity-50",children:b?"Actualizando...":"Actualizar Asignaci\xf3n"})]})})]})]}):(0,t.jsx)("div",{className:"container mx-auto p-6",children:(0,t.jsx)("p",{className:"text-center text-gray-600",children:"Asignaci\xf3n no encontrada."})}):(0,t.jsx)("div",{className:"container mx-auto p-6 text-center text-red-500",children:j})}}},e=>{var a=a=>e(e.s=a);e.O(0,[794,766,441,684,358],()=>a(6534)),_N_E=e.O()}]);