(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[518],{304:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(5155),r=t(5695),l=t(2115),o=t(3464),c=t(6766);function i(){let e=(0,r.useRouter)(),[s,t]=(0,l.useState)([]),[i,n]=(0,l.useState)([]),[d,m]=(0,l.useState)([]),[u,x]=(0,l.useState)(!0),[p,h]=(0,l.useState)(!0),[g,b]=(0,l.useState)(!0),[f,y]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=async()=>{h(!0);try{let e=await o.A.get("http://localhost:4000/personnel-management/get-access-requests");if(e.data.success){let s=e.data.data.map(e=>({...e,request:"solicitud de acceso"}));n(s)}else console.error("API for access requests returned success:false"),f||y("No se pudieron cargar las solicitudes de acceso.")}catch(e){console.error("Error fetching access requests:",e),f||y("Error de red al cargar las solicitudes de acceso.")}finally{h(!1)}},s=async()=>{b(!0);try{let e=await o.A.get("http://localhost:4000/personnel-management/get-assignments");if(console.log("La respuesta del la consulta a los computadores es: ",e),e.data.success){let s=e.data.data.filter(e=>null!==e.id&&void 0!==e.id);s.length!==e.data.data.length&&console.warn("Se filtraron algunas asignaciones de computadora debido a IDs faltantes o nulos.");let t=s.map(e=>({id:e.id,user_id:e.user_id,user_name:e.user_name||"Usuario Desconocido",computer_details:e.computer_serial?"Serial: ".concat(e.computer_serial):"Detalles no disponibles",status:e.status||"pendiente",request:"asignaci\xf3n de computador",created_at:e.assigned_at}));m(t)}else console.error("API for computer assignments returned success:false"),f||y("No se pudieron cargar las asignaciones de computadores.")}catch(e){console.error("Error fetching computer assignments:",e),f||y("Error de red al cargar las asignaciones de computadores.")}finally{b(!1)}};(async()=>{x(!0),y(null);try{let e=(await o.A.get("http://localhost:4000/personnel-management/get-users")).data.map(e=>({...e,request:e.request||"creacion de usuario"}));t(e)}catch(e){console.error("Error fetching user creation requests:",e),y("No se pudieron cargar las solicitudes de creaci\xf3n de usuarios.")}finally{x(!1)}})(),e(),s()},[]);let j=async(e,a)=>{let r,l,c,u,x;if("userCreation"===a){if(!(r=s.find(s=>s.id===e)))return void alert("Error: Solicitud de creaci\xf3n de usuario no encontrada para eliminar.");l="http://localhost:4000/personnel-management/delete-user/".concat(r.id),u=r.name,x=r.request,c='La solicitud de creaci\xf3n para "'.concat(u,'" ha sido eliminada exitosamente.')}else if("accessRequest"===a){if(!(r=i.find(s=>s.id===e)))return void alert("Error: Solicitud de acceso no encontrada para eliminar.");l="http://localhost:4000/personnel-management/delete-access-request/".concat(r.id),u=r.user_name,x="Solicitud de Acceso",c='La solicitud de acceso para "'.concat(u,'" ha sido eliminada exitosamente.')}else{if(!(r=d.find(s=>s.id===e)))return void alert("Error: Solicitud de asignaci\xf3n de computador no encontrada para eliminar.");l="http://localhost:4000/personnel-management/delete-assignment/".concat(r.id),u=r.user_name,x="Asignaci\xf3n de Computador",c='La asignaci\xf3n de computador para "'.concat(u,'" ha sido eliminada exitosamente.')}if(!r){console.error("Solicitud no encontrada para eliminar:",e),alert("Error: No se encontr\xf3 la solicitud especificada.");return}if(confirm('\xbfEst\xe1s seguro de que quieres eliminar "'.concat(u,'" (').concat(x,")?")))try{await o.A.delete(l),alert(c),"userCreation"===a?t(s=>s.filter(s=>s.id!==e)):"accessRequest"===a?n(s=>s.filter(s=>s.id!==e)):m(s=>s.filter(s=>s.id!==e))}catch(s){console.error("Error al eliminar ".concat(x,":"),s);let e="Error de red o al procesar la solicitud de eliminaci\xf3n para ".concat(x,".");if(o.A.isAxiosError(s)&&s.response){var p,h;e="Error al eliminar: ".concat((null==(p=s.response.data)?void 0:p.error)||(null==(h=s.response.data)?void 0:h.message)||s.message)}alert(e)}},N=(s,t)=>{console.log("AAAAAA",s),"userCreation"===t?e.push("/edit-user/".concat(s.id)):"accessRequest"===t?e.push("/edit-access-request/".concat(s.id)):e.push("/edit-computer-assignment/".concat(s.id))};return(0,a.jsxs)("div",{className:"bg-white p-6 md:p-8 rounded-xl shadow-xl w-full max-w-5xl mx-auto my-8",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-center text-gray-700 my-8 md:my-10 px-4",children:"Gesti\xf3n de Ingresos y Recursos de Equipo"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12 px-4",children:[(0,a.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("div",{className:"bg-blue-600 p-3 rounded-full mr-4",children:(0,a.jsx)(c.default,{className:"shrink-0",src:"/img/the-medal-svgrepo-com.svg",alt:"Creaci\xf3n de Usuario",width:48,height:48})}),(0,a.jsx)("div",{children:(0,a.jsx)("h2",{className:"text-lg md:text-xl font-semibold text-gray-700",children:"Creaci\xf3n de Usuario"})})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Registrar a una nueva persona en el equipo."}),(0,a.jsx)("button",{onClick:()=>e.push("/create-user"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 shadow-md",children:"Registrar nuevo ingreso"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("div",{className:"bg-blue-600 p-3 rounded-full mr-4",children:(0,a.jsx)(c.default,{className:"shrink-0",src:"/img/airplane-svgrepo-com.svg",alt:"Solicitud de Accesos",width:48,height:48})}),(0,a.jsx)("div",{children:(0,a.jsx)("h2",{className:"text-lg md:text-xl font-semibold text-gray-700",children:"Solicitud de Accesos"})})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Solicitar permisos para un nuevo miembro del equipo."}),(0,a.jsx)("button",{onClick:()=>e.push("/access-request"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 shadow-md",children:"Solicitar acceso"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("div",{className:"bg-blue-600 p-3 rounded-full mr-4",children:(0,a.jsx)(c.default,{className:"shrink-0",src:"/img/computer-svgrepo-com.svg",alt:"Asignaci\xf3n de Computadores",width:48,height:48})}),(0,a.jsx)("div",{children:(0,a.jsx)("h2",{className:"text-lg md:text-xl font-semibold text-gray-700",children:"Asignaci\xf3n de Computadores"})})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Asignar un equipo port\xe1til a un nuevo ingreso."}),(0,a.jsx)("button",{onClick:()=>e.push("/computer-assignment"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 shadow-md",children:"Asignar computador"})]})]}),(0,a.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-lg mx-4 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl md:text-2xl font-semibold text-gray-700 mb-6",children:"Solicitudes Recientes"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,a.jsx)("th",{className:"py-3 px-4 text-gray-600 font-semibold text-sm",children:"Persona"}),(0,a.jsx)("th",{className:"py-3 px-4 text-gray-600 font-semibold text-sm",children:"Solicitud"}),(0,a.jsx)("th",{className:"py-3 px-4 text-gray-600 font-semibold text-sm",children:"Estado"}),(0,a.jsx)("th",{className:"py-3 px-4 text-gray-600 font-semibold text-sm",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:u||p||g?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"text-center py-4",children:"Cargando solicitudes..."})}):f?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"text-center py-4 text-red-500",children:f})}):0===s.length&&0===i.length&&0===d.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"text-center py-4",children:"No hay solicitudes recientes."})}):(0,a.jsxs)(a.Fragment,{children:[s.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4 text-gray-700",children:e.name}),(0,a.jsx)("td",{className:"py-3 px-4 text-gray-700",children:e.request}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("span",{className:"text-xs font-semibold px-2.5 py-0.5 rounded-full ".concat("pendiente"===e.status.toLowerCase()?"bg-amber-100 text-amber-700":"aprobado"===e.status.toLowerCase()?"bg-green-100 text-green-700":"rechazado"===e.status.toLowerCase()?"bg-red-100 text-red-700":"bg-gray-200 text-gray-700"),children:e.status})}),(0,a.jsxs)("td",{className:"py-3 px-4 space-x-2",children:[(0,a.jsx)("button",{onClick:()=>N(e,"userCreation"),className:"text-blue-600 hover:text-blue-700 font-semibold text-sm",children:"Editar"}),(0,a.jsx)("button",{onClick:()=>j(e.id,"userCreation"),className:"text-red-600 hover:text-red-900 font-semibold text-sm",children:"Eliminar"})]})]},"user-".concat(e.id))),i.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4 text-gray-700",children:e.user_name}),(0,a.jsxs)("td",{className:"py-3 px-4 text-gray-700",children:["solicitud de acceso (",e.access_type,")"]}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("span",{className:"text-xs font-semibold px-2.5 py-0.5 rounded-full ".concat("pendiente"===e.status.toLowerCase()?"bg-amber-100 text-amber-700":"aprobado"===e.status.toLowerCase()?"bg-green-100 text-green-700":"rechazado"===e.status.toLowerCase()?"bg-red-100 text-red-700":"bg-gray-200 text-gray-700"),children:e.status})}),(0,a.jsxs)("td",{className:"py-3 px-4 space-x-2",children:[(0,a.jsx)("button",{onClick:()=>N(e,"accessRequest"),className:"text-blue-600 hover:text-blue-700 font-semibold text-sm",children:"Editar"}),(0,a.jsx)("button",{onClick:()=>j(e.id,"accessRequest"),className:"text-red-600 hover:text-red-900 font-semibold text-sm",children:"Eliminar"})]})]},"access-".concat(e.id))),d.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4 text-gray-700",children:e.user_name}),(0,a.jsxs)("td",{className:"py-3 px-4 text-gray-700",children:[e.request," (",e.computer_details,")"]}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("span",{className:"text-xs font-semibold px-2.5 py-0.5 rounded-full ".concat("pendiente"===e.status.toLowerCase()?"bg-amber-100 text-amber-700":"aprobado"===e.status.toLowerCase()?"bg-green-100 text-green-700":"rechazado"===e.status.toLowerCase()?"bg-red-100 text-red-700":"bg-gray-200 text-gray-700"),children:e.status})}),(0,a.jsxs)("td",{className:"py-3 px-4 space-x-2",children:[(0,a.jsx)("button",{onClick:()=>N(e,"computerAssignment"),className:"text-blue-600 hover:text-blue-700 font-semibold text-sm",children:"Editar"}),(0,a.jsx)("button",{onClick:()=>j(e.id,"computerAssignment"),className:"text-red-600 hover:text-red-900 font-semibold text-sm",children:"Eliminar"})]})]},"computer-".concat(e.id)))]})})]})})]})]})}},4021:(e,s,t)=>{Promise.resolve().then(t.bind(t,304))}},e=>{var s=s=>e(e.s=s);e.O(0,[794,766,441,684,358],()=>s(4021)),_N_E=e.O()}]);