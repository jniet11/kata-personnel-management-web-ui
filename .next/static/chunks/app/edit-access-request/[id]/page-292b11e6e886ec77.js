(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[550],{1143:(e,a,s)=>{Promise.resolve().then(s.bind(s,5232))},5232:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>d});var t=s(5155),l=s(2115),r=s(5695),o=s(6766),i=s(3464);let n=["GitHub","Grafana","AWS","Confluence","Figma","JFROG"],c=["PM","UX","QA","Scrum Master","Developer","BA","DevOps"];function d(){let e=(0,r.useRouter)(),a=(0,r.useParams)().id,[s,d]=(0,l.useState)(null),[u,m]=(0,l.useState)([]),[x,h]=(0,l.useState)(""),[p,b]=(0,l.useState)(""),[g,f]=(0,l.useState)([]),[v,y]=(0,l.useState)(!1),[j,N]=(0,l.useState)(!0),[S,w]=(0,l.useState)(null),[k,A]=(0,l.useState)(null);(0,l.useEffect)(()=>{a&&(N(!0),w(null),A(null),Promise.all([i.A.get("http://localhost:4000/personnel-management/get-access-request-by-id/".concat(a)),i.A.get("http://localhost:4000/personnel-management/get-users")]).then(e=>{let[a,s]=e;if(a.data.success&&a.data.data){let e=a.data.data;d(e),h(String(e.user_id)),b(e.user_type||""),f(e.access_type?e.access_type.split(",").map(e=>e.trim()):[])}else w(a.data.error||"No se pudo cargar la solicitud.");let t=s.data.filter(e=>"aprobado"===e.status.toLowerCase());m(t),0!==t.length||k||A("No hay usuarios aprobados disponibles para seleccionar.")}).catch(e=>{var a,s;console.error("Error fetching data:",e),w("Error al cargar los datos. Por favor, int\xe9ntelo m\xe1s tarde."),(null==(s=e.config)||null==(a=s.url)?void 0:a.includes("get-users"))&&!k&&A("No se pudieron cargar la lista de usuarios aprobados.")}).finally(()=>{N(!1)}))},[a]);let E=e=>{let{value:a,checked:s}=e.target;f(e=>s?[...e,a]:e.filter(e=>e!==a))},_=async t=>{if(t.preventDefault(),s){if(!x)return void w("Por favor, seleccione un usuario.");if(!p)return void w("Por favor, seleccione un tipo de usuario.");if(0===g.length)return void w("Por favor, seleccione al menos un tipo de acceso.");y(!0),w(null);try{await i.A.put("http://localhost:4000/personnel-management/update-access-request/".concat(a),{user_id:x,user_type:p,access_type:g.join(", ")}),alert("Solicitud de acceso actualizada exitosamente!"),e.push("/team-management")}catch(e){if(console.error("Error updating access request:",e),i.A.isAxiosError(e)&&e.response){var l;w((null==(l=e.response.data)?void 0:l.error)||"Error al actualizar la solicitud de acceso.")}else w("Error de red o al procesar la solicitud de actualizaci\xf3n.")}finally{y(!1)}}};return j?(0,t.jsx)("div",{className:"container mx-auto p-6 text-center text-gray-600",children:"Cargando datos..."}):!S||s||j?s||j?(0,t.jsxs)("div",{className:"bg-white p-6 md:p-8 rounded-xl shadow-xl w-full max-w-2xl mx-auto my-8",children:[(0,t.jsxs)("div",{className:"flex items-center mb-6",children:[(0,t.jsx)("div",{className:"bg-blue-600 p-3 rounded-full mr-4",children:(0,t.jsx)(o.default,{className:"shrink-0",src:"/img/airplane-svgrepo-com.svg",alt:"Editar Solicitud Acceso",width:48,height:48})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-700",children:"Editar Solicitud de Acceso"})]}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"text-gray-600 text-sm mb-2",children:["Estado Actual: ",(0,t.jsx)("span",{className:"font-semibold",children:s.status})]}),(0,t.jsxs)("p",{className:"text-gray-600 text-sm mb-6",children:["Fecha Solicitud: ",(0,t.jsx)("span",{className:"font-semibold",children:new Date(s.created_at).toLocaleDateString()})]})]}),(0,t.jsxs)("form",{onSubmit:_,children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"user",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Usuario"}),k&&!j&&0===u.length?(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:k}):(0,t.jsxs)("select",{name:"user",id:"user",value:x,onChange:e=>{h(e.target.value)},className:"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0,disabled:j||0===u.length,children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Seleccione un usuario"}),u.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id)),0===u.length&&!j&&!k&&(0,t.jsx)("option",{value:"",disabled:!0,children:"No hay usuarios aprobados"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"userType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Usuario"}),(0,t.jsxs)("select",{name:"userType",id:"userType",value:p,onChange:e=>{b(e.target.value)},className:"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0,children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Seleccione un tipo"}),c.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Editar Accesos Solicitados"}),(0,t.jsx)("div",{className:"flex flex-col space-y-2",children:n.map(e=>(0,t.jsxs)("label",{className:"inline-flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",value:e,checked:g.includes(e),onChange:E,className:"form-checkbox text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e})]},e))})]})]}),S&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-4 mb-4",children:S}),(0,t.jsx)("div",{className:"mt-8 pt-5 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:()=>e.push("/team-management"),className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg mr-3 transition duration-200",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",disabled:v||j||!s||0===u.length&&!k,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transition duration-200 disabled:opacity-50",children:v?"Actualizando...":"Actualizar Solicitud"})]})})]})]}):(0,t.jsx)("div",{className:"container mx-auto p-6",children:(0,t.jsx)("p",{className:"text-center text-gray-600",children:"Solicitud no encontrada."})}):(0,t.jsx)("div",{className:"container mx-auto p-6 text-center text-red-500",children:S})}}},e=>{var a=a=>e(e.s=a);e.O(0,[794,766,441,684,358],()=>a(1143)),_N_E=e.O()}]);